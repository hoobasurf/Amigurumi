<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test Upload Firebase</title>
</head>
<body>
  <h1>Test Upload Firebase Storage</h1>
  <p id="status">üì§ Pr√™t‚Ä¶</p>

  <script type="module">
    import { storage } from "./firebase.js";
    import { ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-storage.js";

    const status = document.getElementById("status");

    async function testTinyUpload() {
      status.innerHTML = "‚è≥ D√©but upload test‚Ä¶";

      try {
        // Blob ultra-simple
        const blob = new Blob(["test"], { type: "text/plain" });

        // R√©f√©rence Storage
        const fileRef = ref(storage, "test/testfile.txt");

        // Upload
        await uploadBytes(fileRef, blob);

        // R√©cup URL
        const url = await getDownloadURL(fileRef);
        status.innerHTML = "‚úÖ Upload OK !<br>URL : " + url;
        console.log("Upload OK:", url);

      } catch (err) {
        status.innerHTML = "‚ùå Erreur upload : " + err.message;
        console.error("Erreur upload :", err);
      }
    }

    // Lancer le test imm√©diatement
    testTinyUpload();
  </script>
</body>
</html>
