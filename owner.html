<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestion Amigurumi</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="owner-body">

  <h1>Ajouter une crÃ©ation Amigurumi ğŸ§¸ğŸ’–</h1>

  <div class="form-container">
    <label>Nom de la peluche :</label>
    <input id="name" type="text" placeholder="ex : Princesse Lapinou" />

    <label>Photos :</label>
    <input id="photo" type="file" accept="image/*" multiple />

    <label>Rendre publique pour famille/amies :</label>
    <select id="public">
      <option value="true">Oui (visible dans l'album)</option>
      <option value="false">Non (privÃ©)</option>
    </select>

    <button id="save">Enregistrer</button>
    <p id="status">ğŸ“¤ Upload des imagesâ€¦</p>
  </div>

  <h3>Mes projets existants :</h3>
  <div id="projects-container" style="display:flex;gap:10px;flex-wrap:wrap;"></div>

 
<script type="module">
import { db, storage } from "./firebase.js";
import { collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";
import { ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-storage.js";

alert(storage ? "âœ… Storage OK" : "âŒ Storage NON initialisÃ©");

const testRef = ref(storage, "images/test.txt");
alert(testRef ? "âœ… Test ref OK: images/test.txt" : "âŒ Test ref NON crÃ©Ã©");

try {
  // Test Firestore en lecture
  const testCollection = collection(db, "creations");
  alert(testCollection ? "âœ… Firestore OK" : "âŒ Firestore NON initialisÃ©");
} catch (err) {
  alert("âŒ Erreur Firestore: " + err.message);
}

// Test rapide upload Storage (optionnel, tu peux commenter aprÃ¨s test)
async function testUpload() {
  try {
    const blob = new Blob(["test"], { type: "text/plain" });
    const uploadRef = ref(storage, "images/test_upload.txt");
    await uploadBytes(uploadRef, blob);
    const url = await getDownloadURL(uploadRef);
    alert("âœ… Upload OK: " + url);
  } catch (err) {
    alert("âŒ Erreur upload: " + err.message);
  }
}

// DÃ©commenter pour tester l'upload
// testUpload();
</script>
</body>
</html>
